<!doctype html><html lang=zh>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>誰說不能在 vim 裡編譯，從 :make 到 :Make - amikai's blog</title>
<meta name=renderer content="webkit">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<meta http-equiv=cache-control content="no-transform">
<meta http-equiv=cache-control content="no-siteapp">
<meta name=theme-color content="#f8f5ec">
<meta name=msapplication-navbutton-color content="#f8f5ec">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec">
<meta name=author content><meta name=description content="前言 回想一下，上一次使用 vim 寫程式要編譯時，你是怎麼做的 大多人數會將 terminal 切成兩塊，一塊是 vim，一塊是 bash 用來編譯 (如下圖)，編譯有錯誤，則移動到"><meta name=keywords content="go 語言 neovim 環境設定,kubernetes,golang,k8s,neovim">
<meta name=generator content="Hugo 0.87.0 with theme even">
<link rel=canonical href=https://amikai.github.io/2020/09/10/vim-make/>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/manifest.json>
<link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5>
<link href=/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css rel=stylesheet>
<link href=/lib/fancybox/jquery.fancybox-3.1.20.min.css rel=stylesheet>
<meta property="og:title" content="誰說不能在 vim 裡編譯，從 :make 到 :Make">
<meta property="og:description" content="前言 回想一下，上一次使用 vim 寫程式要編譯時，你是怎麼做的 大多人數會將 terminal 切成兩塊，一塊是 vim，一塊是 bash 用來編譯 (如下圖)，編譯有錯誤，則移動到">
<meta property="og:type" content="article">
<meta property="og:url" content="https://amikai.github.io/2020/09/10/vim-make/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2020-09-10T00:21:31+00:00">
<meta property="article:modified_time" content="2020-09-10T00:21:31+00:00">
<meta itemprop=name content="誰說不能在 vim 裡編譯，從 :make 到 :Make">
<meta itemprop=description content="前言 回想一下，上一次使用 vim 寫程式要編譯時，你是怎麼做的 大多人數會將 terminal 切成兩塊，一塊是 vim，一塊是 bash 用來編譯 (如下圖)，編譯有錯誤，則移動到"><meta itemprop=datePublished content="2020-09-10T00:21:31+00:00">
<meta itemprop=dateModified content="2020-09-10T00:21:31+00:00">
<meta itemprop=wordCount content="984">
<meta itemprop=keywords content="vim,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="誰說不能在 vim 裡編譯，從 :make 到 :Make">
<meta name=twitter:description content="前言 回想一下，上一次使用 vim 寫程式要編譯時，你是怎麼做的 大多人數會將 terminal 切成兩塊，一塊是 vim，一塊是 bash 用來編譯 (如下圖)，編譯有錯誤，則移動到"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]-->
</head>
<body>
<div id=mobile-navbar class=mobile-navbar>
<div class=mobile-header-logo>
<a href=/ class=logo>amikai's blog</a>
</div>
<div class=mobile-navbar-icon>
<span></span>
<span></span>
<span></span>
</div>
</div>
<nav id=mobile-menu class="mobile-menu slideout-menu">
<ul class=mobile-menu-list>
<a href=/>
<li class=mobile-menu-item>Home</li>
</a><a href=/post/>
<li class=mobile-menu-item>Archives</li>
</a><a href=/tags/>
<li class=mobile-menu-item>Tags</li>
</a><a href=/categories/>
<li class=mobile-menu-item>Categories</li>
</a>
</ul>
</nav>
<div class=container id=mobile-panel>
<header id=header class=header>
<div class=logo-wrapper>
<a href=/ class=logo>amikai's blog</a>
</div>
<nav class=site-navbar>
<ul id=menu class=menu>
<li class=menu-item>
<a class=menu-item-link href=/>Home</a>
</li><li class=menu-item>
<a class=menu-item-link href=/post/>Archives</a>
</li><li class=menu-item>
<a class=menu-item-link href=/tags/>Tags</a>
</li><li class=menu-item>
<a class=menu-item-link href=/categories/>Categories</a>
</li>
</ul>
</nav>
</header>
<main id=main class=main>
<div class=content-wrapper>
<div id=content class=content>
<article class=post>
<header class=post-header>
<h1 class=post-title>誰說不能在 vim 裡編譯，從 :make 到 :Make</h1>
<div class=post-meta>
<span class=post-time> 2020-09-10 </span>
</div>
</header>
<div class=post-toc id=post-toc>
<h2 class=post-toc-title></h2>
<div class="post-toc-content always-active">
<nav id=TableOfContents>
<ul>
<li><a href=#內建-make>內建 <code>:make</code></a></li>
<li><a href=#如虎添翼的-quickfix-window>如虎添翼的 quickfix-window</a></li>
</ul>
<ul>
<li><a href=#vim-使用-make-指令那是不是只有-makefile-才能用>vim 使用 <code>:make</code> 指令，那是不是只有 Makefile 才能用?</a></li>
</ul>
</nav>
</div>
</div>
<div class=post-content>
<h1 id=前言>前言</h1>
<p>回想一下，上一次使用 vim 寫程式要編譯時，你是怎麼做的</p>
<p>大多人數會將 terminal 切成兩塊，一塊是 vim，一塊是 bash 用來編譯 (如下圖)，編譯有錯誤，則移動到 vim 更改。若編譯錯誤可能上百個，使用該方式，每條錯誤都需要找到該檔案，並且來回修改即編譯，會相當沒效率。</p>
<p>本文以 C 語言專案為例，聊聊強大的 vim 在這種情境下有什麼好的解決方案。
<img src=tmux_split.png alt></p>
<h1 id=強大的-make>強大的 <code>:make</code></h1>
<h2 id=內建-make>內建 <code>:make</code></h2>
<p>此次範例就拿 neovim 原始碼，根據官方文件的編譯方法 <code>make CMAKE_BUILD_TYPE=Release</code>，所以我在 vim 裡進行編譯 <code>:make CMAKE_BUILD_TYPE=Release</code></p>
<blockquote>
<p>沒錯，在 vim 裡是可以用 <code>:make</code> 執行 Makefile</p>
</blockquote>
<p>編譯完後，可以看到下圖，出現許多錯誤，案 Enter 後則回到平常。
<img src=make_cmd.png alt></p>
<p>這時可以使用 <code>:cl</code> 指令將這些錯誤列出來。</p>
<p><img src=clist_cmd.png alt></p>
<p>使用 <code>:cn</code> 或 <code>cnext</code> 跳到下一個錯誤位置</p>
<p>使用 <code>:cp</code> 或 <code>:cprevious</code> 跳到上一個錯誤位置</p>
<p>看上圖，可以觀察到每一條錯誤前面都有一個數字，可以使用 <code>:cc [number]</code> 跳轉到想要的錯誤，舉例：跳轉到第一個錯誤就用 <code>:cc 12</code>，跳轉到第三個錯誤就用 <code>:cc 19</code>。</p>
<p>火力展示如下圖<img src=clist_demo.gif alt></p>
<p>總結指令:</p>
<ul>
<li><code>:make</code>: 執行 makefile</li>
<li><code>:cl</code>: 列出所有錯誤</li>
<li><code>:cn</code>: 跳到下個錯誤</li>
<li><code>:cp</code>: 跳到上個錯誤</li>
<li><code>:cc [number]</code>: 跳轉到特定錯誤</li>
</ul>
<h2 id=如虎添翼的-quickfix-window>如虎添翼的 quickfix-window</h2>
<p>使用 <code>:clist</code> 可以快速的列出結果，案下 <code>&lt;enter></code> 則會關閉，並且開始執行跳轉的動做。</p>
<p>但這還不夠方便，當 <code>:clist</code> 列出來的結果很多條可能超過螢幕，並且每次想重新查詢一次都得在打一次指令，而且不能在這些文字進行字串搜尋。</p>
<blockquote>
<p>另一種查看錯誤的方式則是用 <code>:copen</code> 打開 quickfix window (如下圖)，<code>:clist</code> 和 <code>:copen</code> 列出的結果會是一模一樣的，只是提供了另一種顯示方式。</p>
</blockquote>
<p>我們可以將游標放到 quickfix window 裡的錯誤上按下 <code>&lt;enter></code> 即可跳轉，用法直覺，而且不需要每次重新開啟列表，也可以在此視窗裡查詢字串。</p>
<p>而且剛剛提到的跳轉指令<code>:cn</code> <code>:cp</code> <code>:cc [number]</code> 也都可以配合使用。</p>
<p><img src=copen_cmd.png alt></p>
<p>Note: 詳見 <code>:help quickfix-window</code></p>
<h1 id=讓你飛起來的-vim-dispatch>讓你飛起來的 vim-dispatch</h1>
<p>使用 vim 內建的 <code>:make</code> 指令，在編譯時會卡住整個 vim，並且什麼都不能做，只能看著它編譯，因此 vim-dispatch 外掛完美解決了這個問題。</p>
<p>使用 vim-plug 安裝:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=nx>Plug</span> <span class=s1>&#39;tpope/vim-dispatch&#39;</span><span class=err>
</span></code></pre></td></tr></table>
</div>
</div><p>vim-dispath 的用法相當簡單，只要記住兩個指令即可</p>
<ul>
<li>
<p><code>:Make</code> ： 意義和 <code>:make</code> 一樣，只是不會卡住 vim</p>
</li>
<li>
<p><code>:Copen</code> ：意義和 <code>:copen</code> 一樣會打開 quickfix window</p>
</li>
</ul>
<p>當然最一開始所說的跳轉指令，也能使用。此外掛跟 vim 內建的使用方式幾乎完全相同，只是指令稍微有差異。</p>
<p><code>:Make</code> 編譯展示，可以看到下方在編譯，同時上方在移動游標:
<img src=Make_demo.gif alt></p>
<h1 id=q--a>Q & A</h1>
<h2 id=vim-使用-make-指令那是不是只有-makefile-才能用>vim 使用 <code>:make</code> 指令，那是不是只有 Makefile 才能用?</h2>
<p>當然不是，其他語言的社群為了也會提供一樣的功能，讓使用者在能無痛使用這個功能</p>
<ul>
<li><a href=https://github.com/rust-lang/rust.vim>rust.vim</a>: 原本 rust 編譯方式是 <code>cargo build</code>，使用此外掛之後，在 vim 裡使用 <code>:make build</code> 就好，以此類推 <code>:make run</code> 就是 <code>cargo run</code></li>
</ul>
<h1 id=reference>Reference</h1>
<ul>
<li><a href=https://www.ptt.cc/bbs/Editor/M.1285722960.A.BF5.html>Re: [轉錄][問題] VIM 編譯與執行</a></li>
<li><code>:help quickfix</code></li>
</ul>
</div>
<footer class=post-footer>
<div class=post-tags>
<a href=/tags/vim/>vim</a>
</div>
<nav class=post-nav>
<a class=prev href=/2020/09/22/vim-text-object/>
<i class="iconfont icon-left"></i>
<span class="prev-text nav-default">你應該擴充的 text object</span>
<span class="prev-text nav-mobile"></span>
</a>
<a class=next href=/2020/09/07/vim-mark-tips/>
<span class="next-text nav-default">聊聊 vim mark 使用情境 - code 參照</span>
<span class="next-text nav-mobile"></span>
<i class="iconfont icon-right"></i>
</a>
</nav>
</footer>
</article>
</div>
<script src=https://utteranc.es/client.js repo=amikai/my_hugo_blog_utterances issue-term=pathname theme=github-light crossorigin=anonymous async></script>
<noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript>
</div>
</main>
<footer id=footer class=footer>
<div class=social-links>
<a href=https://www.linkedin.com/in/yun-kai-chuang-122064a5/ class="iconfont icon-linkedin" title=linkedin></a>
<a href=https://github.com/amikai class="iconfont icon-github" title=github></a>
<a href=https://amikai.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a>
</div>
<div class=copyright>
<span class=power-by>
%!(EXTRA string=<a class=hexo-link href=https://gohugo.io>Hugo</a>)
</span>
<span class=division>|</span>
<span class=theme-info>
-
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a>
</span>
<span class=copyright-year>
&copy;
-
2022<span class=heart><i class="iconfont icon-heart"></i></span><span></span>
</span>
</div>
</footer>
<div class=back-to-top id=back-to-top>
<i class="iconfont icon-up"></i>
</div>
</div>
<script type=text/javascript src=/lib/jquery/jquery-3.2.1.min.js></script>
<script type=text/javascript src=/lib/slideout/slideout-1.0.1.min.js></script>
<script type=text/javascript src=/lib/fancybox/jquery.fancybox-3.1.20.min.js></script>
<script type=text/javascript src=/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-172478407-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</body>
</html>