<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Golang 開發環境 - 使用 neovim 0.5 | no code no pain</title><meta name=keywords content="vim,neovim"><meta name=description content="Neovim 簡介 neovim 從 vim 專案 fork 之後，新增了 async 功能，所有工作不會再被單一線程給擋住 (在過去 linter 檢查時，是無法寫程式碼的)，大大提升了可用性和使用者體驗，朝現代編輯器躍進了一大步。neovim 並沒有因此停下腳步，在之後的版本陸續推出了
remote plugin：使得寫 plugin 不在受限於 vimscript，可以使用其他語言並且基於 client server 架構和 neovim 溝通，這樣就能好好的利用各個語言生態系的工具，製作出更多有彈性的套件。ex: deoplete.nvim 和 defx.nvim 皆是 python 所撰寫的 remote plugin
treesitter 的支援：過去 vim 的 syntax highlight 都是靠 regex，現在可以使用 treesitter ，效能更好，抓詞的時候更準確
支援 lua 寫套件：可以完全使用 lua 撰寫套件 ，脫離怪異的 vimscript，和 remote plugin 不同，remote plugin 是基於 client server 架構通訊
built-in LSP client (0.5)：內建 LSP client，使用者可以透過 neovim LSP api 和 LSP server 互動"><meta name=author content="amikai"><link rel=canonical href=https://amikai.github.io/post/go_neovim_env_0.5/><link crossorigin=anonymous href=/assets/css/stylesheet.d82d618ab18b8061cce6b313e7a33a5aef50405951b08c5c64e523c4465ce711.css integrity="sha256-2C1hirGLgGHM5rMT56M6Wu9QQFlRsIxcZOUjxEZc5xE=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://amikai.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://amikai.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://amikai.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://amikai.github.io/apple-touch-icon.png><link rel=mask-icon href=https://amikai.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://amikai.github.io/post/go_neovim_env_0.5/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-172478407-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Golang 開發環境 - 使用 neovim 0.5"><meta property="og:description" content="Neovim 簡介 neovim 從 vim 專案 fork 之後，新增了 async 功能，所有工作不會再被單一線程給擋住 (在過去 linter 檢查時，是無法寫程式碼的)，大大提升了可用性和使用者體驗，朝現代編輯器躍進了一大步。neovim 並沒有因此停下腳步，在之後的版本陸續推出了
remote plugin：使得寫 plugin 不在受限於 vimscript，可以使用其他語言並且基於 client server 架構和 neovim 溝通，這樣就能好好的利用各個語言生態系的工具，製作出更多有彈性的套件。ex: deoplete.nvim 和 defx.nvim 皆是 python 所撰寫的 remote plugin
treesitter 的支援：過去 vim 的 syntax highlight 都是靠 regex，現在可以使用 treesitter ，效能更好，抓詞的時候更準確
支援 lua 寫套件：可以完全使用 lua 撰寫套件 ，脫離怪異的 vimscript，和 remote plugin 不同，remote plugin 是基於 client server 架構通訊
built-in LSP client (0.5)：內建 LSP client，使用者可以透過 neovim LSP api 和 LSP server 互動"><meta property="og:type" content="article"><meta property="og:url" content="https://amikai.github.io/post/go_neovim_env_0.5/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-08-16T15:20:34+08:00"><meta property="article:modified_time" content="2021-08-16T15:20:34+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Golang 開發環境 - 使用 neovim 0.5"><meta name=twitter:description content="Neovim 簡介 neovim 從 vim 專案 fork 之後，新增了 async 功能，所有工作不會再被單一線程給擋住 (在過去 linter 檢查時，是無法寫程式碼的)，大大提升了可用性和使用者體驗，朝現代編輯器躍進了一大步。neovim 並沒有因此停下腳步，在之後的版本陸續推出了
remote plugin：使得寫 plugin 不在受限於 vimscript，可以使用其他語言並且基於 client server 架構和 neovim 溝通，這樣就能好好的利用各個語言生態系的工具，製作出更多有彈性的套件。ex: deoplete.nvim 和 defx.nvim 皆是 python 所撰寫的 remote plugin
treesitter 的支援：過去 vim 的 syntax highlight 都是靠 regex，現在可以使用 treesitter ，效能更好，抓詞的時候更準確
支援 lua 寫套件：可以完全使用 lua 撰寫套件 ，脫離怪異的 vimscript，和 remote plugin 不同，remote plugin 是基於 client server 架構通訊
built-in LSP client (0.5)：內建 LSP client，使用者可以透過 neovim LSP api 和 LSP server 互動"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://amikai.github.io/post/"},{"@type":"ListItem","position":3,"name":"Golang 開發環境 - 使用 neovim 0.5","item":"https://amikai.github.io/post/go_neovim_env_0.5/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Golang 開發環境 - 使用 neovim 0.5","name":"Golang 開發環境 - 使用 neovim 0.5","description":"Neovim 簡介 neovim 從 vim 專案 fork 之後，新增了 async 功能，所有工作不會再被單一線程給擋住 (在過去 linter 檢查時，是無法寫程式碼的)，大大提升了可用性和使用者體驗，朝現代編輯器躍進了一大步。neovim 並沒有因此停下腳步，在之後的版本陸續推出了\nremote plugin：使得寫 plugin 不在受限於 vimscript，可以使用其他語言並且基於 client server 架構和 neovim 溝通，這樣就能好好的利用各個語言生態系的工具，製作出更多有彈性的套件。ex: deoplete.nvim 和 defx.nvim 皆是 python 所撰寫的 remote plugin\ntreesitter 的支援：過去 vim 的 syntax highlight 都是靠 regex，現在可以使用 treesitter ，效能更好，抓詞的時候更準確\n支援 lua 寫套件：可以完全使用 lua 撰寫套件 ，脫離怪異的 vimscript，和 remote plugin 不同，remote plugin 是基於 client server 架構通訊\nbuilt-in LSP client (0.5)：內建 LSP client，使用者可以透過 neovim LSP api 和 LSP server 互動","keywords":["vim","neovim"],"articleBody":" Neovim 簡介 neovim 從 vim 專案 fork 之後，新增了 async 功能，所有工作不會再被單一線程給擋住 (在過去 linter 檢查時，是無法寫程式碼的)，大大提升了可用性和使用者體驗，朝現代編輯器躍進了一大步。neovim 並沒有因此停下腳步，在之後的版本陸續推出了\nremote plugin：使得寫 plugin 不在受限於 vimscript，可以使用其他語言並且基於 client server 架構和 neovim 溝通，這樣就能好好的利用各個語言生態系的工具，製作出更多有彈性的套件。ex: deoplete.nvim 和 defx.nvim 皆是 python 所撰寫的 remote plugin\ntreesitter 的支援：過去 vim 的 syntax highlight 都是靠 regex，現在可以使用 treesitter ，效能更好，抓詞的時候更準確\n支援 lua 寫套件：可以完全使用 lua 撰寫套件 ，脫離怪異的 vimscript，和 remote plugin 不同，remote plugin 是基於 client server 架構通訊\nbuilt-in LSP client (0.5)：內建 LSP client，使用者可以透過 neovim LSP api 和 LSP server 互動\n支援 init.lua：可以用 lua 撰寫 vimrc，本章也會用到此功能\n2021 的 0.5 版本發佈，除了古老的文字介面，neovim 可說是不折不扣的現代編輯器。\n編輯器基本功能 一個現代的編輯器應該有以下幾種基本功能：\n客製化 Color scheme\nAuto completion - 自動補全引擎\nFile manager - 可以在側邊欄看到專案的結構\nAsync linter - 在寫程式碼犯錯的同時，有錯誤提示\nBackground compile - 編譯的同時不應該卡住整個 Editor，要讓使用者能做其他事情\nCode navigation - 包含跳轉到定義，跳轉到型態定義\nCode outliner - 當一個檔案寫得很長的時候，怎麼綜觀全局，並且在這些函式中快速跳轉\nFuzzy Finder - 透過 fuzzy finder 找到想要的檔案或是專案裡的字串等等\n本篇將會使用短小的 lua 設定檔達到基礎 go 語言的開發環境，並產出 init.lua 檔案\n預備動作 安裝 neovim 0.5 stable brew install neovim\n如果不知道在 neovim 裏如何使用 lua，可參考 nanotee/nvim-lua-guide\n本章使用到的 packer.nvim ，可以翻閱一下 README，知道基本用法和操作\ninit.lua 設置 Color scheme 選一個適合自己眼睛的主題吧，推薦 gruvbox-material\nuse { 'sainnhe/gruvbox-material', setup = function() vim.g.gruvbox_material_background = 'soft' end, config = function() vim.cmd[[colorscheme gruvbox-material]] end } File explorer - nerdtree 雖然在上篇我不推薦使用 nerdtree，並且端出了需要高度手動配置的 defx.nvim。經過仔細思考之後發現這是個人偏好，不應該拉讀者一起折騰，沒有什麼特殊需求的話，大部分的情況下 nerdtree 是很夠用的，使用者體驗也不錯。老牌的 nerdtree 使用上相對穩定，也會找到較多的討論。\n安裝 nerdtree\nuse { 'preservim/nerdtree', setup = function() -- Read the following nerdtree section and add what you need end } 映射 打開或關閉 nerdtree\nvim.api.nvim_set_keymap(\"n\", \"\", \"NERDTreeToggle\" ,{silent = true, noremap = true}) 在 nerdtree 只要會使用兩個按鍵就能存活\n? 打開 quick menu 列出所有基本的案鍵映射\nm 對游標下的檔案或檔案夾列出基本操作選單\nvim-go 強大的 vim-go 提供了各式各樣 go 語言的開發功能，每一個使用 vim 開發 go 的人一定都用過。它包括了 auto completion, code navigation, background compilation, code format…功能，我將會介紹 vim-go 如何使用這些功能\n安裝 vim-go\nuse { 'fatih/vim-go', run = ':GoUpdateBinaries', ft = 'go', setup = function() -- Read the following section and add what you need end } Auto-complete vim-go 提供的 auto completion 使用 omnifunc 實作 (:help omnifunc)，omnifunc 使用 觸發並彈出候選補全選單，按起來很不順手，為了更好的體驗，我將設定成：\n觸發候補選單或是跳到下一個候選，沒有候選時就輸出 tab 字元\n觸發候補選單或跳到上一個候選，沒有候選時就刪除 tab 字元\n完成補全，沒有候選時就輸出下一行\nlocal t = function(str) return vim.api.nvim_replace_termcodes(str, true, true, true) end local check_back_space = function() local col = vim.fn.col('.') - 1 if col == 0 or vim.fn.getline('.'):sub(col, col):match('%s') then return true else return false end end _G.tab_complete = function() if vim.fn.pumvisible() == 1 then return t \"\" elseif check_back_space() then return t \"\" else return t \"\" end end _G.s_tab_complete = function() if vim.fn.pumvisible() == 1 then return t \"\" else return t \"\" end end _G.enter_key = function() if vim.fn.pumvisible() == 1 then return t \"\" else return t \"\" end end vim.api.nvim_set_keymap(\"i\", \"\", \"=v:lua.tab_complete()\" ,{silent = true, noremap = true}) vim.api.nvim_set_keymap(\"i\", \"\", \"=v:lua.s_tab_complete()\" ,{silent = true, noremap = true}) vim.api.nvim_set_keymap('i', '', '=v:lua.enter_key()' ,{silent = true, noremap = true}) Code navigation - vim-go :GoDef 或是 gd 跳轉到定義 (gd 映射是 vim-go 內建，不需額外設定)\n[[ ]] motion\n[[ 跳到上一個 function 宣告處 ]] 跳到下一個 function 宣告處 使用 :GoRefer 或是映射 gr 列出 referrer 到 location list\nvim.api.nvim_set_keymap('n', 'gr', '(go-referrers)') Background compile - vim-go vim-go 提供了編譯和執行的指令，可以輕鬆在 vim 裏編譯、執行\n:GoRun 跑起 main package\n:GoBuild 編譯\n如果專案使用 Makefile，可以使用 vim-dispatch 參考我另一篇文章\nCode format - vim-go :GoFmt 排版程式碼\n不想手動可以在每次儲存時自動排版 vim.g.go_fmt_autosave = 1\nAsync linter - 使用 nvim-lspconfig 安裝 nvim-lspconfig 並且設定 gopls\nuse { 'neovim/nvim-lspconfig', config = function() require('lspconfig').gopls.setup{} -- Read the following lspconfig section and add what you need end } 將 diagnostic 資訊顯示在程式碼旁\ndiagnostic_config = { -- Enable underline, use default values underline = true, -- Enable virtual text, override spacing to 2 virtual_text = { spacing = 2, prefix = '\u003c', }, -- Use a function to dynamically turn signs off -- and on, using buffer local variables signs = function(bufnr, client_id) local ok, result = pcall(vim.api.nvim_buf_get_var, bufnr, 'show_signs') -- No buffer local variable set, so just enable by default if not ok then return true end return result end, -- Disable a feature update_in_insert = false, } vim.lsp.handlers[\"textDocument/publishDiagnostics\"] = vim.lsp.with( vim.lsp.diagnostic.on_publish_diagnostics, diagnostic_config)``` - 在 diagnostic 之間跳轉 - 映射 `[d` `]d` 跳轉到上一個和下一個 diagnostic - ```plain text vim.api.nvim_set_keymap('n', '[d', 'lua vim.lsp.diagnostic.goto_prev()',{silent = true, noremap = true}) vim.api.nvim_set_keymap('n', ']d', 'lua vim.lsp.diagnostic.goto_next()',{silent = true, noremap = true}) Code outline - tagbar 安裝 gotags:\n$ go get -u github.com/jstemmer/gotags 直接照 gotags 文件的設定\nuse { 'preservim/tagbar', cmd = 'TagbarToggle', setup = function() -- Read the following tagbar section and add what you need end } 直接照 gotags 文件的設定\nvim.g.tagbar_type_go = { ctagstype = 'go', kinds = { 'p:package', 'i:imports:1', 'c:constants', 'v:variables', 't:types', 'n:interfaces', 'w:fields', 'e:embedded', 'm:methods', 'r:constructor', 'f:functions' }, sro = '.', kind2scope = { t = 'ctype', n = 'ntype', }, scope2kind = { ctype = 't', ntype = 'n' }, ctagsbin = 'gotags', ctagsargs = '-sort -silent' } 映射 開啟或是關閉 tagbar\nvim.api.nvim_set_keymap(\"n\", \"\", \"TagbarToggle\" ,{silent = true, noremap = true}) Fuzzy finder - Telescope 作為 neovim built-in LSP client 的主要開發者 tjdevries 所主導開發的 fuzzy finder，早晚會成為 neovim 界 fuzzy finder 的主流，在大部分的使用情境下可以取代 fzf.vim，並且使用 lua 開發。\nTelescope 的 live_grep 和 find_files 是預設使用 ripgrep 安裝 rigrep\n$ brew install ripgrep 安裝 telescope\nuse { 'nvim-telescope/telescope.nvim', requires = {{'nvim-lua/popup.nvim'}, {'nvim-lua/plenary.nvim'}}, cmd = 'Telescope', setup = function() -- Read the following telescope section and add what you need end } 映射 fg 即時文字搜索\nvim.api.nvim_set_keymap('n', 'fg', 'lua require('telescope.builtin').live_grep()', {noremap = true}) 映射 ff 尋找 file\nvim.api.nvim_set_keymap('n', 'ff', 'lua require('telescope.builtin').find_files()', {noremap = true}) 結語 最後完成的 init.lua，貼上內容重開 neovim 後，記得使用 PackerSync 安裝套件\n本篇的用意和上篇一樣，盡量用精簡的設定檔和少量的套件打造一個短小精幹的 go 語言基礎開發環境，但使用效果和體驗和上篇效果相當，大部分的 go 語言開發功能都透用 vim-go 達成。\n雖然我針對了了七個從 coloscheme 到 \u0008fuzzy finder 重點功能，但這其實只是個開始，你應該把這篇所寫的設定檔當成一個骨架繼續改進，甚至只要記這七個重點功能的用意，替換成你覺得更棒的，比如說你覺得 fzf 比 telescope 更棒，或是你覺得 ycm 補全比 vim-go 內建的更優秀，那就換吧，往\"打造成自己最合適的開發環境\"這條道路前進。\n參考來源 Vim 和 Neovim 的前世今生 How to set up Neovim 0.5 + Modern plugins (LSP, Treesitter, Fuzzy finder, etc) :help vim-go :help nvim-lspconfig ","wordCount":"862","inLanguage":"zh","datePublished":"2021-08-16T15:20:34+08:00","dateModified":"2021-08-16T15:20:34+08:00","author":{"@type":"Person","name":"amikai"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://amikai.github.io/post/go_neovim_env_0.5/"},"publisher":{"@type":"Organization","name":"no code no pain","logo":{"@type":"ImageObject","url":"https://amikai.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://amikai.github.io accesskey=h title="no code no pain (Alt + H)">no code no pain</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://amikai.github.io/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://amikai.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://amikai.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://amikai.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Golang 開發環境 - 使用 neovim 0.5</h1><div class=post-meta><span title='2021-08-16 15:20:34 +0800 +0800'>八月 16, 2021</span>&nbsp;·&nbsp;amikai</div></header><div class=post-content><p><img loading=lazy src=gopher_golang_neovim.png alt></p><h1 id=neovim-簡介>Neovim 簡介<a hidden class=anchor aria-hidden=true href=#neovim-簡介>#</a></h1><p>neovim 從 vim 專案 fork 之後，新增了 async 功能，所有工作不會再被單一線程給擋住 (在過去 linter 檢查時，是無法寫程式碼的)，大大提升了可用性和使用者體驗，朝現代編輯器躍進了一大步。neovim 並沒有因此停下腳步，在之後的版本陸續推出了</p><ul><li><p>remote plugin：使得寫 plugin 不在受限於 vimscript，可以使用其他語言並且基於 client server 架構和 neovim 溝通，這樣就能好好的利用各個語言生態系的工具，製作出更多有彈性的套件。ex: deoplete.nvim 和 defx.nvim 皆是 python 所撰寫的 remote plugin</p></li><li><p>treesitter 的支援：過去 vim 的 syntax highlight 都是靠 regex，現在可以使用 treesitter ，效能更好，抓詞的時候更準確</p></li><li><p>支援 lua 寫套件：可以完全使用 lua 撰寫套件 ，脫離怪異的 vimscript，和 remote plugin 不同，remote plugin 是基於 client server 架構通訊</p></li><li><p>built-in LSP client (0.5)：內建 LSP client，使用者可以透過 neovim LSP api 和 LSP server 互動</p></li><li><p>支援 init.lua：可以用 lua 撰寫 vimrc，本章也會用到此功能</p></li></ul><blockquote><p>2021 的 0.5 版本發佈，除了古老的文字介面，neovim 可說是不折不扣的現代編輯器。</p></blockquote><h1 id=編輯器基本功能>編輯器基本功能<a hidden class=anchor aria-hidden=true href=#編輯器基本功能>#</a></h1><p>一個現代的編輯器應該有以下幾種基本功能：</p><ul><li><p>客製化 Color scheme</p></li><li><p>Auto completion - 自動補全引擎</p></li><li><p>File manager - 可以在側邊欄看到專案的結構</p></li><li><p>Async linter - 在寫程式碼犯錯的同時，有錯誤提示</p></li><li><p>Background compile - 編譯的同時不應該卡住整個 Editor，要讓使用者能做其他事情</p></li><li><p>Code navigation - 包含跳轉到定義，跳轉到型態定義</p></li><li><p>Code outliner - 當一個檔案寫得很長的時候，怎麼綜觀全局，並且在這些函式中快速跳轉</p></li><li><p>Fuzzy Finder - 透過 fuzzy finder 找到想要的檔案或是專案裡的字串等等</p></li></ul><blockquote><p>本篇將會使用短小的 lua 設定檔達到基礎 go 語言的開發環境，並產出 init.lua 檔案</p></blockquote><h1 id=預備動作>預備動作<a hidden class=anchor aria-hidden=true href=#預備動作>#</a></h1><ul><li><p>安裝 neovim 0.5 stable <code>brew install neovim</code></p></li><li><p>如果不知道在 neovim 裏如何使用 lua，可參考 <a href=https://github.com/nanotee/nvim-lua-guide>nanotee/nvim-lua-guide</a></p></li><li><p>本章使用到的 <a href=https://github.com/wbthomason/packer.nvim>packer.nvim</a> ，可以翻閱一下 README，知道基本用法和操作</p></li></ul><h1 id=initlua-設置>init.lua 設置<a hidden class=anchor aria-hidden=true href=#initlua-設置>#</a></h1><h2 id=color-scheme>Color scheme<a hidden class=anchor aria-hidden=true href=#color-scheme>#</a></h2><p>選一個適合自己眼睛的主題吧，推薦 <code>gruvbox-material</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>use {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;sainnhe/gruvbox-material&#39;</span>,
</span></span><span style=display:flex><span>    setup <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>()
</span></span><span style=display:flex><span>        vim.g.gruvbox_material_background <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;soft&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>,
</span></span><span style=display:flex><span>    config <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>()
</span></span><span style=display:flex><span>        vim.cmd<span style=color:#e6db74>[[colorscheme gruvbox-material]]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=file-explorer---nerdtree>File explorer - nerdtree<a hidden class=anchor aria-hidden=true href=#file-explorer---nerdtree>#</a></h2><p><img loading=lazy src=nerdtree.png alt=nerdtree></p><p>雖然在<a href=https://amikai.github.io/post/go_neovim_env/>上篇</a>我不推薦使用 nerdtree，並且端出了需要高度手動配置的 defx.nvim。經過仔細思考之後發現這是個人偏好，不應該拉讀者一起折騰，沒有什麼特殊需求的話，大部分的情況下 nerdtree 是很夠用的，使用者體驗也不錯。老牌的 nerdtree 使用上相對穩定，也會找到較多的討論。</p><p>安裝 nerdtree</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>use {
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#39;preservim/nerdtree&#39;</span>,
</span></span><span style=display:flex><span>    setup <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>()
</span></span><span style=display:flex><span>    	<span style=color:#75715e>-- Read the following nerdtree section and add what you need</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>映射 <code>&lt;F4></code> 打開或關閉 nerdtree</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>vim.api.nvim_set_keymap(<span style=color:#e6db74>&#34;n&#34;</span>, <span style=color:#e6db74>&#34;&lt;F4&gt;&#34;</span>, <span style=color:#e6db74>&#34;&lt;cmd&gt;NERDTreeToggle&lt;cr&gt;&#34;</span> ,{silent <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>, noremap <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>})
</span></span></code></pre></div><p>在 nerdtree 只要會使用兩個按鍵就能存活</p><ul><li><p><code>?</code> 打開 quick menu 列出所有基本的案鍵映射</p></li><li><p><code>m</code> 對游標下的檔案或檔案夾列出基本操作選單</p></li></ul><h2 id=vim-go>vim-go<a hidden class=anchor aria-hidden=true href=#vim-go>#</a></h2><p>強大的 vim-go 提供了各式各樣 go 語言的開發功能，每一個使用 vim 開發 go 的人一定都用過。它包括了 auto completion, code navigation, background compilation, code format&mldr;功能，我將會介紹 vim-go 如何使用這些功能</p><p>安裝 vim-go</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>use {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;fatih/vim-go&#39;</span>,
</span></span><span style=display:flex><span>    run <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;:GoUpdateBinaries&#39;</span>,
</span></span><span style=display:flex><span>    ft <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;go&#39;</span>,
</span></span><span style=display:flex><span>    setup <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>()
</span></span><span style=display:flex><span>    	<span style=color:#75715e>-- Read the following section and add what you need</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=auto-complete>Auto-complete<a hidden class=anchor aria-hidden=true href=#auto-complete>#</a></h2><p>vim-go 提供的 auto completion 使用 omnifunc 實作 (<code>:help omnifunc</code>)，omnifunc 使用 <code>&lt;c-x>&lt;c-o></code> 觸發並彈出候選補全選單，按起來很不順手，為了更好的體驗，我將設定成：</p><ul><li><p><code>&lt;tab></code> 觸發候補選單或是跳到下一個候選，沒有候選時就輸出 tab 字元</p></li><li><p><code>&lt;s-tab></code> 觸發候補選單或跳到上一個候選，沒有候選時就刪除 tab 字元</p></li><li><p><code>&lt;enter></code> 完成補全，沒有候選時就輸出下一行</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span><span style=color:#66d9ef>local</span> t <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(str)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> vim.api.nvim_replace_termcodes(str, <span style=color:#66d9ef>true</span>, <span style=color:#66d9ef>true</span>, <span style=color:#66d9ef>true</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>local</span> check_back_space <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>local</span> col <span style=color:#f92672>=</span> vim.fn.col(<span style=color:#e6db74>&#39;.&#39;</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> col <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>or</span> vim.fn.getline(<span style=color:#e6db74>&#39;.&#39;</span>):sub(col, col):match(<span style=color:#e6db74>&#39;%s&#39;</span>) <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>_G.tab_complete <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> vim.fn.pumvisible() <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> t <span style=color:#e6db74>&#34;&lt;C-n&gt;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elseif</span> check_back_space() <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> t <span style=color:#e6db74>&#34;&lt;Tab&gt;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> t <span style=color:#e6db74>&#34;&lt;C-x&gt;&lt;C-o&gt;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>_G.s_tab_complete <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> vim.fn.pumvisible() <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> t <span style=color:#e6db74>&#34;&lt;C-p&gt;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> t <span style=color:#e6db74>&#34;&lt;C-h&gt;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>_G.enter_key <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> vim.fn.pumvisible() <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> t <span style=color:#e6db74>&#34;&lt;C-y&gt;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> t <span style=color:#e6db74>&#34;&lt;CR&gt;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>vim.api.nvim_set_keymap(<span style=color:#e6db74>&#34;i&#34;</span>, <span style=color:#e6db74>&#34;&lt;tab&gt;&#34;</span>, <span style=color:#e6db74>&#34;&lt;C-R&gt;=v:lua.tab_complete()&lt;CR&gt;&#34;</span> ,{silent <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>, noremap <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>})
</span></span><span style=display:flex><span>vim.api.nvim_set_keymap(<span style=color:#e6db74>&#34;i&#34;</span>, <span style=color:#e6db74>&#34;&lt;s-tab&gt;&#34;</span>, <span style=color:#e6db74>&#34;&lt;C-R&gt;=v:lua.s_tab_complete()&lt;CR&gt;&#34;</span> ,{silent <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>, noremap <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>})
</span></span><span style=display:flex><span>vim.api.nvim_set_keymap(<span style=color:#e6db74>&#39;i&#39;</span>, <span style=color:#e6db74>&#39;&lt;enter&gt;&#39;</span>, <span style=color:#e6db74>&#39;&lt;C-R&gt;=v:lua.enter_key()&lt;CR&gt;&#39;</span> ,{silent <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>, noremap <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>})
</span></span></code></pre></div><h2 id=code-navigation---vim-go>Code navigation - vim-go<a hidden class=anchor aria-hidden=true href=#code-navigation---vim-go>#</a></h2><ul><li><p><code>:GoDef</code> 或是 <code>gd</code> 跳轉到定義 (<code>gd</code> 映射是 vim-go 內建，不需額外設定)</p></li><li><p><code>[[</code> <code>]]</code> motion</p><ul><li><code>[[</code> 跳到上一個 function 宣告處</li><li><code>]]</code> 跳到下一個 function 宣告處</li></ul></li><li><p>使用 <code>:GoRefer</code> 或是映射 <code>gr</code> 列出 referrer 到 location list</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>vim.api.nvim_set_keymap(<span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#e6db74>&#39;gr&#39;</span>, <span style=color:#e6db74>&#39;&lt;Plug&gt;(go-referrers)&#39;</span>)
</span></span></code></pre></div><h2 id=background-compile---vim-go>Background compile - vim-go<a hidden class=anchor aria-hidden=true href=#background-compile---vim-go>#</a></h2><p>vim-go 提供了編譯和執行的指令，可以輕鬆在 vim 裏編譯、執行</p><ul><li><p><code>:GoRun</code> 跑起 main package</p></li><li><p><code>:GoBuild</code> 編譯</p></li><li><p>如果專案使用 Makefile，可以使用 vim-dispatch 參考我<a href=https://amikai.github.io/post/vim-make/>另一篇文章</a></p></li></ul><h2 id=code-format---vim-go>Code format - vim-go<a hidden class=anchor aria-hidden=true href=#code-format---vim-go>#</a></h2><ul><li><p><code>:GoFmt</code> 排版程式碼</p></li><li><p>不想手動可以在每次儲存時自動排版
<code>vim.g.go_fmt_autosave = 1</code></p></li></ul><h2 id=async-linter---使用-nvim-lspconfig>Async linter - 使用 nvim-lspconfig<a hidden class=anchor aria-hidden=true href=#async-linter---使用-nvim-lspconfig>#</a></h2><p><img loading=lazy src=diagnostic.png alt=diagnostic></p><p>安裝 nvim-lspconfig 並且設定 gopls</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>use {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;neovim/nvim-lspconfig&#39;</span>,
</span></span><span style=display:flex><span>     config <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>()
</span></span><span style=display:flex><span>		require(<span style=color:#e6db74>&#39;lspconfig&#39;</span>).gopls.setup{}
</span></span><span style=display:flex><span>  		<span style=color:#75715e>-- Read the following lspconfig section and add what you need</span>
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>將 diagnostic 資訊顯示在程式碼旁</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>diagnostic_config <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>-- Enable underline, use default values</span>
</span></span><span style=display:flex><span>    underline <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>-- Enable virtual text, override spacing to 2</span>
</span></span><span style=display:flex><span>    virtual_text <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        spacing <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>        prefix <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;&#39;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#75715e>-- Use a function to dynamically turn signs off</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>-- and on, using buffer local variables</span>
</span></span><span style=display:flex><span>    signs <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(bufnr, client_id)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>local</span> ok, result <span style=color:#f92672>=</span> pcall(vim.api.nvim_buf_get_var, bufnr, <span style=color:#e6db74>&#39;show_signs&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#75715e>-- No buffer local variable set, so just enable by default</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> ok <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>-- Disable a feature</span>
</span></span><span style=display:flex><span>    update_in_insert <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>vim.lsp.handlers[<span style=color:#e6db74>&#34;textDocument/publishDiagnostics&#34;</span>] <span style=color:#f92672>=</span> vim.lsp.with(
</span></span><span style=display:flex><span>    vim.lsp.diagnostic.on_publish_diagnostics, diagnostic_config)<span style=color:#960050;background-color:#1e0010>```</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>在</span> diagnostic <span style=color:#960050;background-color:#1e0010>之間跳轉</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>映射</span> <span style=color:#960050;background-color:#1e0010>`</span>[d<span style=color:#960050;background-color:#1e0010>`</span> <span style=color:#960050;background-color:#1e0010>`</span>]d<span style=color:#960050;background-color:#1e0010>`</span> <span style=color:#960050;background-color:#1e0010>跳轉到上一個和下一個</span> diagnostic
</span></span><span style=display:flex><span>            <span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>```</span>plain text
</span></span><span style=display:flex><span>vim.api.nvim_set_keymap(<span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#e6db74>&#39;[d&#39;</span>, <span style=color:#e6db74>&#39;&lt;cmd&gt;lua vim.lsp.diagnostic.goto_prev()&lt;CR&gt;&#39;</span>,{silent <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>, noremap <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>})
</span></span><span style=display:flex><span>vim.api.nvim_set_keymap(<span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#e6db74>&#39;]d&#39;</span>, <span style=color:#e6db74>&#39;&lt;cmd&gt;lua vim.lsp.diagnostic.goto_next()&lt;CR&gt;&#39;</span>,{silent <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>, noremap <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>})
</span></span></code></pre></div><h2 id=code-outline---tagbar>Code outline - tagbar<a hidden class=anchor aria-hidden=true href=#code-outline---tagbar>#</a></h2><p><img loading=lazy src=tagbar.png alt=tagbar></p><p>安裝 gotags:</p><pre tabindex=0><code>$ go get -u github.com/jstemmer/gotags
</code></pre><p>直接照 gotags 文件的設定</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>use {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;preservim/tagbar&#39;</span>,
</span></span><span style=display:flex><span>    cmd <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;TagbarToggle&#39;</span>,
</span></span><span style=display:flex><span>    setup <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>()
</span></span><span style=display:flex><span>    	<span style=color:#75715e>-- Read the following tagbar section and add what you need</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>直接照 gotags 文件的設定</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>vim.g.tagbar_type_go <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    ctagstype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;go&#39;</span>,
</span></span><span style=display:flex><span>    kinds <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;p:package&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;i:imports:1&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;c:constants&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;v:variables&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;t:types&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;n:interfaces&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;w:fields&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;e:embedded&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;m:methods&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;r:constructor&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;f:functions&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    sro <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;.&#39;</span>,
</span></span><span style=display:flex><span>    kind2scope <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        t <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ctype&#39;</span>,
</span></span><span style=display:flex><span>        n <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ntype&#39;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    scope2kind <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        ctype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;t&#39;</span>,
</span></span><span style=display:flex><span>        ntype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;n&#39;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    ctagsbin  <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;gotags&#39;</span>,
</span></span><span style=display:flex><span>    ctagsargs <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;-sort -silent&#39;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>映射 開啟或是關閉 tagbar</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>vim.api.nvim_set_keymap(<span style=color:#e6db74>&#34;n&#34;</span>, <span style=color:#e6db74>&#34;&lt;F8&gt;&#34;</span>, <span style=color:#e6db74>&#34;&lt;cmd&gt;TagbarToggle&lt;cr&gt;&#34;</span> ,{silent <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>, noremap <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>})
</span></span></code></pre></div><h2 id=fuzzy-finder---telescope>Fuzzy finder - Telescope<a hidden class=anchor aria-hidden=true href=#fuzzy-finder---telescope>#</a></h2><p><img loading=lazy src=telescope.png alt=telescope></p><p>作為 neovim built-in LSP client 的主要開發者 tjdevries 所主導開發的 fuzzy finder，早晚會成為 neovim 界 fuzzy finder 的主流，在大部分的使用情境下可以取代 fzf.vim，並且使用 lua 開發。</p><p>Telescope 的 live_grep 和 find_files 是預設使用 ripgrep
安裝 rigrep</p><pre tabindex=0><code>$ brew install ripgrep
</code></pre><p>安裝 telescope</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>use {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;nvim-telescope/telescope.nvim&#39;</span>,
</span></span><span style=display:flex><span>    requires <span style=color:#f92672>=</span> {{<span style=color:#e6db74>&#39;nvim-lua/popup.nvim&#39;</span>}, {<span style=color:#e6db74>&#39;nvim-lua/plenary.nvim&#39;</span>}},
</span></span><span style=display:flex><span>    cmd <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Telescope&#39;</span>,
</span></span><span style=display:flex><span>    setup <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>()
</span></span><span style=display:flex><span>    <span style=color:#75715e>-- Read the following telescope section and add what you need</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>映射 <code>&lt;leader>fg</code> 即時文字搜索</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>vim.api.nvim_set_keymap(<span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#e6db74>&#39;&lt;leader&gt;fg&#39;</span>, <span style=color:#e6db74>&#39;&lt;cmd&gt;lua require(&#39;</span>telescope.builtin<span style=color:#e6db74>&#39;).live_grep()&lt;cr&gt;&#39;</span>, {noremap <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>})
</span></span></code></pre></div><p>映射 <code>&lt;leader>ff</code> 尋找 file</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>vim.api.nvim_set_keymap(<span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#e6db74>&#39;&lt;leader&gt;ff&#39;</span>, <span style=color:#e6db74>&#39;&lt;cmd&gt;lua require(&#39;</span>telescope.builtin<span style=color:#e6db74>&#39;).find_files()&lt;cr&gt;&#39;</span>, {noremap <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>})
</span></span></code></pre></div><h1 id=結語>結語<a hidden class=anchor aria-hidden=true href=#結語>#</a></h1><blockquote><p>最後完成的 <a href=init.lua>init.lua</a>，貼上內容重開 neovim 後，記得使用 <code>PackerSync</code> 安裝套件</p></blockquote><p>本篇的用意和<a href=https://amikai.github.io/post/go_neovim_env/>上篇</a>一樣，盡量用精簡的設定檔和少量的套件打造一個短小精幹的 go 語言基礎開發環境，但使用效果和體驗和上篇效果相當，大部分的 go 語言開發功能都透用 vim-go 達成。</p><p>雖然我針對了了七個從 coloscheme 到 fuzzy finder 重點功能，但這其實只是個開始，你應該把這篇所寫的設定檔當成一個骨架繼續改進，甚至只要記這七個重點功能的用意，替換成你覺得更棒的，比如說你覺得 fzf 比 telescope 更棒，或是你覺得 ycm 補全比 vim-go 內建的更優秀，那就換吧，往"打造成自己最合適的開發環境"這條道路前進。</p><h1 id=參考來源>參考來源<a hidden class=anchor aria-hidden=true href=#參考來源>#</a></h1><ul><li><a href=https://jdhao.github.io/2020/01/12/vim_nvim_history_development/>Vim 和 Neovim 的前世今生</a></li><li><a href=https://blog.inkdrop.app/how-to-set-up-neovim-0-5-modern-plugins-lsp-treesitter-etc-542c3d9c9887>How to set up Neovim 0.5 + Modern plugins (LSP, Treesitter, Fuzzy finder, etc)</a></li><li><a href=https://github.com/fatih/vim-go/blob/master/doc/vim-go.txt><code>:help vim-go</code></a></li><li><a href=https://github.com/neovim/nvim-lspconfig/blob/master/doc/lspconfig.txt><code>:help nvim-lspconfig</code></a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://amikai.github.io/tags/vim/>vim</a></li><li><a href=https://amikai.github.io/tags/neovim/>neovim</a></li></ul></footer><script src=https://utteranc.es/client.js repo=amikai/my_hugo_blog_utterances issue-term=title label=amikai/my_hugo_blog_utterances theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2023 <a href=https://amikai.github.io>no code no pain</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="複製";function s(){t.innerHTML="複製成功！",setTimeout(()=>{t.innerHTML="複製"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>